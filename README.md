Инструкция к запуску файлов

1. Файл DatasetCreating\_step1 для формирования датасета:

- скопировать/переместить 1 картинку (больше не позволяет объем ОЗУ в Collab) из папки DatasetCreating/all\_images и соответствующую ей маску из папки DatasetCreating/all\_masks в папки current\_image и current\_mask;
- в ячейке random choice of necessary amount of images задать параметр len как наибольшее возможное количество черно-белых изображений (см. вывод параметра wb в ячейке class balancing выше). Полученные картинки сохраняются в соответствующих папках в DatasetCreating/datasets;
- если будет необходимость раздробить несколько картинок, то нужно удалить картинку и маску из папок current\_, добавить новые, перезапустить код и в ячейке saving train images поменять n с 0 на уже сохраненное количество картинок в соответствующих папках.

2. Файл DatasetCreating\_step2 для балансировки датасета

3. Файл Learning для обучения модели запускать с GPU:

- запустить весь файл, выставив количество эпох num\_epochs в ячейке вызова модели (первая эпоха может обучаться до 1-1.5 часов из-за считывания файлов с гугл-диска, остальные эпохи проходят примерно за 2.5-3 минуты);
- сохраненные веса можно найти в папке TyurinaAV\_segmentation/Learning;

4. Файл Test для предсказания масок на тестовом датасете запускать с GPU:

- в ячейке loading images and masks выбрать нужную тестовую картинку и маску с названиями \_A0, …, \_B3;
- в ячейке dataset creating установить размер пакета batch\_size в соответствии с таблицей:

|Имя файла|batch\_size|n\_crops|org\_img\_size|
| :-: | :-: | :-: | :-: |
|A0|35|1155|8558, 9163|
|A1|37|1221|8605, 9562|
|A2|35|1085|8099, 9163|
|B0|37|1258|8769, 9562|
|B1|34|1054|8004, 8764|
|B2|34|1054|8166, 8764|
|B3|34|1020|7758, 8764|

- в ячейке restoring predicted mask установить n\_crops в соответствии с таблицей;
- в ячейке saving predicted mask установить org\_img\_size в соответствии с таблицей;
- предсказанную маску можно увидеть в блокноте или в папке Test/.
